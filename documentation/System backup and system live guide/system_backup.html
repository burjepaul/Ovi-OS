<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@500&family=Poppins&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>

    <title>OviOS Linux</title>
    <link rel="icon" type="image/png" href="/Images/Favicon.jpg" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="download-body-tag">
      <!-- Nav Bar -->
      <section class="navigation-section" id="nav-Section">
        <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark py-0">
          <a href="">
            <img
              class="navbar-logo"
              src="/Images/LogoImage.png"
              style="margin-left: 15%"
              alt=""
            />
          </a>
          <a class="navbar-brand" style="margin-left: 1%" href=""
            >Ovi OS Linux</a
          >
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarTogglerDemo01"
            aria-controls="navbarTogglerDemo01"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
            <ul class="navbar-nav ms-auto">
              <li class="navbar-item">
                <a href="../../index.html" class="nav-link">Home</a>
              </li>
              <li class="navbar-item">
                <a href="../../nav-content/download/download.html" class="nav-link">Download</a>
              </li>
              <li class="navbar-item">
                <div class="dropdown">
                  <button
                    class="btn btn-dark dropdown-toggle"
                    type="button"
                    id="dropdownMenuButton2"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                  >
                    Documentation
                  </button>
                  <ul
                    class="dropdown-menu dropdown-menu-dark"
                    aria-labelledby="dropdownMenuButton2"
                  >
                    <li>
                      <li>
                        <a
                          class="dropdown-item"
                          href="../Documentation/documentation.html"
                          >Documentation</a
                        >
                      </li>
                      <a
                        class="dropdown-item"
                        href="../The admin guide/adminguide.html"
                        >The Admin Guide</a
                      >
                    </li>
                    <li>
                      <a
                        class="dropdown-item"
                        href=""
                        >System backup and system live guide</a
                      >
                    </li>
                    <li>
                      <a
                        class="dropdown-item"
                        href="../The autosnap Guide/autosnap.html"
                        >The 'autosnap' Guide</a
                      >
                    </li>
                    <li>
                      <a
                        class="dropdown-item"
                        href="../The 'bondadm' Guide/bondadm.html"
                        >The 'bondadm' Guide</a
                      >
                    </li>
                    <li>
                      <a
                        class="dropdown-item"
                        href="../The 'options Guide/options.html"
                        >The 'options' Guide</a
                      >
                    </li>
                    <li>
                      <a
                        class="dropdown-item"
                        href="../The OviOS HA Cluster Guide/"
                        >The OviOS HA Cluster Guide</a
                      >
                    </li>
                  </ul>
                </div>
              </li>
              <li class="navbar-item">
                <a class="nav-link" href="../../nav-content/use-cases/use-cases.html"
                  >Use Cases</a
                >
              </li>
              <li class="navbar-item">
                <a class="nav-link" href="../../nav-content/FAQ/FAQ.html">FAQ & Features</a>
              </li>
              <li class="navbar-item">
                <a class="nav-link" href="../../nav-content/contact/contact.html">Contact</a>
              </li>
              <li class="navbar-item">
                <a class="nav-link" href="../../nav-content/Services/services.html"
                  >Services</a
                >
              </li>
            </ul>
          </div>
        </nav>
      </section>

      <!-- Title section -->
      <div class="title">
        <h1>System backup and system live guide</h1>
      </div>

      <!-- Buttons section -->
      <section class="buttons-section">
        <div class="buttons-container">
          <div class="mini-titles">
            <a href="#osBackup">1. Define an OS Backup Pool.</a>
            <a href="#defFiles">2. Define files and / or directories to be backed up.</a>
            <a href="#createBackup">3. Create a backup.</a>
            <a href="#restore">4. Restore after a reboot.</a>
          </div>
        </div>
      </section>

      <div class="plain-text">
        <p>
          <strong>&nbsp&nbsp&nbsp&nbspOviOS Linux Live is a method to use OviOS only running from a live CD without having to install.</strong>
        </p>
        <p>
          &nbsp&nbsp&nbsp&nbspOviOS Linux boots the live image writable in memory, allowing the system to be configured as if it was installed. The challenge here is to save the configuration in case of an intentional or unintentional reboot.
        </p>
        <p>
          &nbsp&nbsp&nbsp&nbspSaving and restoring the configuration in OviOS Linux live is very simple and straightforward.
        </p>
      </div>

      <div class="documentation-text">
        <div class="plain-text" id="osBackup">
          <h2>1. Define an OS Backup Pool.</h2>
          <p>
            &nbsp&nbsp&nbsp&nbspThis is a storage pool that will contain a small volume called "osbackup". The system will store here system backups.
          </p>
          <p>
            or example, if the pool is called "OVIOSPOOL"
          </p>
            <p class="old-type">
              ovios-shell&gt; options system.backup.pool OVIOSPOOL <br>
Changing option: system.backup.pool ==&gt; OVIOSPOOL <br>
ovios-shell&gt; <br>
            </p> <br>
            <p>
              Note: If you want to reset this option, use reset, or like other options type ""
            </p>
            <p> This means a pool named "reset" wouldn't work.</p>
            <p class="old-type">
              ovios-shell&gt; options system.backup.pool reset
            </p> <br>
            <p>OR</p>
            <p class="old-type">
              ovios-shell&gt; options system.backup.pool "" <br>
Changing option: system.backup.pool ==&gt; <br>
ovios-shell&gt; <br>
            </p> <br>
        </div>
        <br>
        <div class="plain-text" id="defFiles">
          <h2>2. Define files and / or directories to be backed up.</h2>
          <p>
            By default, sync-config (the tool used for backups) backs up the following system configuration files and directories:
          </p>
          <p class="old-type">/etc/passwd  <br>
            /etc/group  <br>
            /etc/shadow  <br>
            /etc/samba/ <br>
            /etc/krb5.conf  <br>
            /etc/hosts <br>
            /etc/resolv.conf <br> 
            /etc/nsswitch.conf  <br> 
            /etc/security/  <br>
            /etc/pam.d/system-auth <br>
            /etc/tgt/  <br>
            /var/lib/samba/ <br> 
            /etc/sysconfig/ovios.conf</p> <br>
          <p>Usually, when using OviOS Live, at least the network files should be added to this list.</p>
          <p>Add files with options files.to.sync:</p>
          <p class="old-type">ovios-shell&gt; options files.to.sync "/etc/sysconfig/ov-net/ /etc/ypserv.conf /etc/yp.conf"
            Changing option: files.to.sync ==&gt; /etc/sysconfig/ov-net/ /etc/ypserv.conf /etc/yp.conf
            ovios-shell&gt;</p> <br>
          <p>In this example we added the ov-net directory which contains the network configuration files, and the yp.conf and ypserv.conf files. </p>
          <p>You must use this format as in the example above, leave spaces to separate different files and folders.</p>
        </div>
        <br>
        <div class="plain-text" id="createBackup">
          <h2>3. Create a backup.</h2>
          <p>
            Run the sync-config tool with option bo or backup-only. If it's the first time you run it, the osbackup dataset will be created and the backup will be written there.
          </p>
          <p>ovios-shell&gt; sync-config bo <br>
            osbackup dataset doesn't exist on OVIOSPOOL. Creating now.. <br>
            Created osbackup dataset <br>
            Creating /ovios/OVIOSPOOL/osbackup/osbackup-2020-10-19_13-14-31.tar.gz ... <br>
            Created backup osbackup-2020-10-19_13-14-31.tar.gz <br>
            ovios-shell&gt;</p> <br>
            <p>If the osbackup dataset already exists, the sync-config tool will create a new backup on it.</p>
            <p class="old-type">
              ovios-shell&gt; sync-config bo <br>
Found backup location to be /ovios/OVIOSPOOL/osbackup <br>
Creating /ovios/OVIOSPOOL/osbackup/osbackup-2020-10-19_13-14-55.tar.gz ... <br>
Created backup osbackup-2020-10-19_13-14-55.tar.gz <br>
ovios-shell&gt; <br>
            </p>
        </div>
        <br>
        <div class="plain-text" id="restore">
          <h2>4. Restore after a reboot.</h2>
          <p>
            After a reboot (or in any situation when the Admin needs to restore the config from a backup), make sure the OS system backup pool is imported.
          </p>
          <p>
            You need to disable the skip.import option, enable forced import if this is a live system, and run zfs-admin start.
          </p>

          <p class="old-type">
            ovios-shell&gt; options skip.import off <br>
Changing option: skip.import ==&gt; off <br>
ovios-shell&gt; options force.import on <br>
Changing option: force.import ==&gt; on <br>
ovios-shell&gt; <br>
ovios-shell&gt; zfs-admin start <br>
     Starting importing pools <br>
     SPL Module already loaded <br>
     ZFS Module already loaded <br>
  *  Starting the ZFS Event Daemon... &nbsp&nbsp&nbsp&nbsp                [  OK  ] <br>
  *  Importing OVIOSPOOL... &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp                        [  OK  ] <br>
  *  Starting mount on all datasets... &nbsp&nbsp&nbsp               [  OK  ] <br>
  *  Starting share on all datasets...    &nbsp&nbsp&nbsp              [  OK  ] <br>
ovios-shell&gt; <br>
          </p>
          <p>Drop to the bash shell, if at this point you are in the ovios-shell,  change directory to your root filesystem (/) and extract the latest backup.</p>
          <p class="old-type">
            ovios-shell&gt; linuxcmd <br>
Dropping to the Linux bash shell... <br>
ovios-indt:~ # cd / <br>
ovios-indt:/ # tar xvf /ovios/OVIOSPOOL/osbackup/osbackup-2020-10-19_13-14- <br>
osbackup-2020-10-19_13-14-31.tar.gz  osbackup-2020-10-19_13-14-55.tar.gz <br>
ovios-indt:/ # tar xvf /ovios/OVIOSPOOL/osbackup/osbackup-2020-10-19_13-14-55.tar.gz <br>
etc/passwd <br>
etc/group <br>
etc/shadow <br>
etc/samba/ <br>
etc/samba/smb.conf <br>
etc/samba/smb.conf.default <br>
etc/krb5.conf <br>
etc/hosts  <br>
etc/resolv.conf <br>
etc/nsswitch.conf <br>
etc/security/ <br>
etc/security/namespace.conf <br>
etc/security/limits.d/ <br>
etc/security/namespace.d/ <br>
etc/security/access.conf <br>
etc/security/time.conf <br>
etc/security/limits.conf <br>
etc/security/pam_env.conf <br>
etc/security/namespace.init <br>
etc/security/group.conf <br>
etc/pam.d/system-auth <br>
etc/tgt/ <br>
etc/tgt/examples/ <br>
etc/tgt/examples/targets.conf.vtl.MSL2024 <br>
etc/tgt/examples/targets.conf.example <br>
etc/tgt/examples/targets.conf.vtl.L700 <br>
etc/tgt/conf.d/ <br>
etc/tgt/targets.conf <br>
var/lib/samba/ <br>
var/lib/samba/share_info.tdb <br>
var/lib/samba/bind-dns/ <br>
var/lib/samba/group_mapping.tdb <br>
var/lib/samba/winbindd_cache.tdb <br>
var/lib/samba/account_policy.tdb <br>
var/lib/samba/registry.tdb <br>
var/lib/samba/private/ <br>
var/lib/samba/private/secrets.tdb <br>
var/lib/samba/private/passdb.tdb <br>
var/lib/samba/private/netlogon_creds_cli.tdb <br>
var/lib/samba/private/msg.sock/ <br>
var/lib/samba/usershares/ <br>
var/lib/samba/winbindd_privileged/ <br>
var/lib/samba/winbindd_idmap.tdb <br>
etc/sysconfig/ovios.conf <br>
          </p> <br>
          <p>After this step, you should run:</p>
          <p class="old-type">
            ovios-indt:/ # exit <br>
exit <br>
ovios-shell&gt; <br>
          </p>
          <p>To go back to the ovios-shell.</p>
          <p>Then, to start up the interfaces and re-assign the IPs:</p>
          <p class="old-type">
            ovios-shell&gt; services restart network <br>
  *  Stopping dhcpcd on the eth0 interface..  . <br>                                                                                                                       [  OK  ] <br>
  &nbsp&nbsp&nbsp&nbsp    Bringing up the eth0 interface... <br>
  &nbsp&nbsp&nbsp&nbsp   Starting dhcpcd on the eth0 interface...DUID 00:01:00:01:1f:3e:93:d8:10:c3:7b:45:c0:fc <br>
eth0: IAID 29:e4:50:77 <br>
eth0: rebinding lease of 192.168.43.139 <br>
eth0: leased 192.168.43.139 for 1800 seconds <br>
eth0: changing route to 192.168.43.0/24 <br>
eth0: changing default route via 192.168.43.2 <br>
forked to background, child pid 6605 <br>
  *                                      <br>                                                                                                                           [  OK  ] <br>
ovios-shell&gt; <br>
          </p>
          <p>And:</p>
          <p class="old-type">ovios-shell&gt; services start</p> <br>
          <p>To start all services which were previously enabled with the "options" command.</p>
        </div>
        <br>
      </div>

      <footer>
        <div class="row div-container">
          <div class="col-md-3 div-footer sign">
            <a href="">
              <img
                src="/Images/Favicon copy.png"
                width="130px"
                style="margin-left: 15%"
                alt=""
              />
              <a class="navbar-brand footer-text-logo" href="">Ovi OS Linux</a>
            </a>
          </div>
          <div class="col-md-3 div-footer">
            <h5>Documentation</h5>
            <br />
            <a href="../The admin guide/adminguide.html"
              >The Admin Guide</a
            >
            <br />
            <a
              href="../System backup and system live guide/system_backup.html"
              >System backup and system live guide</a
            >
            <br />
            <a href="../The autosnap Guide/autosnap.html"
              >The 'autosnap' Guide</a
            >
            <br />
            <a href="../The 'bondadm' Guide/bondadm.html"
              >The 'bondadm' Guide</a
            >
            <br />
            <a href="../The 'options Guide/options.html"
              >The 'options' Guide</a
            >
            <br />
            <a
              href="../The OviOS HA Cluster Guide/"
              >The OviOS HA Cluster Guide</a
            >
            <br /><br /><br />
          </div>
          <div class="col-md-3 div-footer">
            <h5>Technology</h5>
            <br />
            <a href="../../nav-content/download/download.html">Download</a>
            <br />
            <a href="../../nav-content/use-cases/use-cases.html">Use Cases</a>
            <br />
            <a href="../../nav-content/FAQ/FAQ.html">FAQ & Features</a>
            <br />
            <a href="../../nav-content/Services/services.html">Services</a>
            <br /><br /><br />
          </div>
          <div class="col-md-3 div-footer">
            <h5>Contact</h5>
            <br />
            <a href="../../nav-content/contact/contact.html">ovi@ovios.org</a>
          </div>
        </div>
        <div class="social-media-logos">
          <a href="https://twitter.com/ovioslinux" target="_blank">
            <i class="fa-brands fa-twitter"></i
          ></a>
          <a
            href="https://www.youtube.com/c/oviosorgstorage/videos"
            target="_blank"
            ><i class="fa-brands fa-youtube"></i
          ></a>
          <p class="copyright-text">Copyright © 2012-2022 OviOS Linux</p>
        </div>
      </footer>
    </div>
    <!-- Script -->
    <script src="script.js"></script>
  </body>
</html>
